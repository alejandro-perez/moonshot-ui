/* moonshot-server.c generated by valac 0.10.4, the Vala compiler
 * generated from moonshot-server.vala, do not modify */


#include <glib.h>
#include <glib-object.h>
#include <gtk/gtk.h>
#include <gio/gio.h>
#include <stdlib.h>
#include <string.h>


#define TYPE_MOONSHOT_SERVER (moonshot_server_get_type ())
#define MOONSHOT_SERVER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_MOONSHOT_SERVER, MoonshotServer))
#define MOONSHOT_SERVER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_MOONSHOT_SERVER, MoonshotServerClass))
#define IS_MOONSHOT_SERVER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_MOONSHOT_SERVER))
#define IS_MOONSHOT_SERVER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_MOONSHOT_SERVER))
#define MOONSHOT_SERVER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_MOONSHOT_SERVER, MoonshotServerClass))

typedef struct _MoonshotServer MoonshotServer;
typedef struct _MoonshotServerClass MoonshotServerClass;
typedef struct _MoonshotServerPrivate MoonshotServerPrivate;

#define TYPE_IDENTITY_MANAGER_VIEW (identity_manager_view_get_type ())
#define IDENTITY_MANAGER_VIEW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_IDENTITY_MANAGER_VIEW, IdentityManagerView))
#define IDENTITY_MANAGER_VIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_IDENTITY_MANAGER_VIEW, IdentityManagerViewClass))
#define IS_IDENTITY_MANAGER_VIEW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_IDENTITY_MANAGER_VIEW))
#define IS_IDENTITY_MANAGER_VIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_IDENTITY_MANAGER_VIEW))
#define IDENTITY_MANAGER_VIEW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_IDENTITY_MANAGER_VIEW, IdentityManagerViewClass))

typedef struct _IdentityManagerView IdentityManagerView;
typedef struct _IdentityManagerViewClass IdentityManagerViewClass;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))

#define TYPE_IDENTITY_REQUEST (identity_request_get_type ())
#define IDENTITY_REQUEST(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_IDENTITY_REQUEST, IdentityRequest))
#define IDENTITY_REQUEST_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_IDENTITY_REQUEST, IdentityRequestClass))
#define IS_IDENTITY_REQUEST(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_IDENTITY_REQUEST))
#define IS_IDENTITY_REQUEST_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_IDENTITY_REQUEST))
#define IDENTITY_REQUEST_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_IDENTITY_REQUEST, IdentityRequestClass))

typedef struct _IdentityRequest IdentityRequest;
typedef struct _IdentityRequestClass IdentityRequestClass;
typedef struct _IdentityRequestPrivate IdentityRequestPrivate;

#define TYPE_ID_CARD (id_card_get_type ())
#define ID_CARD(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_ID_CARD, IdCard))
#define ID_CARD_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_ID_CARD, IdCardClass))
#define IS_ID_CARD(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_ID_CARD))
#define IS_ID_CARD_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_ID_CARD))
#define ID_CARD_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_ID_CARD, IdCardClass))

typedef struct _IdCard IdCard;
typedef struct _IdCardClass IdCardClass;

#define TYPE_TRUST_ANCHOR (trust_anchor_get_type ())
#define TRUST_ANCHOR(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_TRUST_ANCHOR, TrustAnchor))
#define TRUST_ANCHOR_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_TRUST_ANCHOR, TrustAnchorClass))
#define IS_TRUST_ANCHOR(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_TRUST_ANCHOR))
#define IS_TRUST_ANCHOR_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_TRUST_ANCHOR))
#define TRUST_ANCHOR_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_TRUST_ANCHOR, TrustAnchorClass))

typedef struct _TrustAnchor TrustAnchor;
typedef struct _TrustAnchorClass TrustAnchorClass;
typedef struct _Block3Data Block3Data;
typedef struct _MoonshotServerGetIdentityData MoonshotServerGetIdentityData;
typedef struct _Block4Data Block4Data;
typedef struct _MoonshotServerGetDefaultIdentityData MoonshotServerGetDefaultIdentityData;

#define TYPE_RULE (rule_get_type ())
typedef struct _Rule Rule;

#define WEB_PROVISIONING_TYPE_PARSER (web_provisioning_parser_get_type ())
#define WEB_PROVISIONING_PARSER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), WEB_PROVISIONING_TYPE_PARSER, WebProvisioningParser))
#define WEB_PROVISIONING_PARSER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), WEB_PROVISIONING_TYPE_PARSER, WebProvisioningParserClass))
#define WEB_PROVISIONING_IS_PARSER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), WEB_PROVISIONING_TYPE_PARSER))
#define WEB_PROVISIONING_IS_PARSER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), WEB_PROVISIONING_TYPE_PARSER))
#define WEB_PROVISIONING_PARSER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), WEB_PROVISIONING_TYPE_PARSER, WebProvisioningParserClass))

typedef struct _WebProvisioningParser WebProvisioningParser;
typedef struct _WebProvisioningParserClass WebProvisioningParserClass;
#define _web_provisioning_parser_unref0(var) ((var == NULL) ? NULL : (var = (web_provisioning_parser_unref (var), NULL)))

struct _MoonshotServer {
	GObject parent_instance;
	MoonshotServerPrivate * priv;
};

struct _MoonshotServerClass {
	GObjectClass parent_class;
};

struct _MoonshotServerPrivate {
	IdentityManagerView* main_window;
};

typedef void (*ReturnIdentityCallback) (IdentityRequest* request, void* user_data);
struct _IdentityRequest {
	GObject parent_instance;
	IdentityRequestPrivate * priv;
	IdCard* id_card;
	gboolean complete;
	gboolean select_default;
	char* nai;
	char* password;
	char* service;
};

struct _IdentityRequestClass {
	GObjectClass parent_class;
};

struct _Block3Data {
	int _ref_count_;
	MoonshotServer * self;
	gpointer _async_data_;
};

struct _MoonshotServerGetIdentityData {
	int _state_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	MoonshotServer* self;
	char* nai;
	char* password;
	char* service;
	char* nai_out;
	char* password_out;
	char* server_certificate_hash;
	char* ca_certificate;
	char* subject_name_constraint;
	char* subject_alt_name_constraint;
	gboolean result;
	IdentityRequest* request;
	char* _tmp0_;
	char* _tmp1_;
	char* _tmp2_;
	char* _tmp3_;
	char* _tmp4_;
	char* _tmp5_;
	IdCard* id_card;
	char* _tmp6_;
	char* _tmp7_;
	char* _tmp8_;
	char* _tmp9_;
	char* _tmp10_;
	char* _tmp11_;
	char* _tmp12_;
	char* _tmp13_;
	char* _tmp14_;
	char* _tmp15_;
	char* _tmp16_;
	char* _tmp17_;
	Block3Data* _data3_;
};

struct _Block4Data {
	int _ref_count_;
	MoonshotServer * self;
	gpointer _async_data_;
};

struct _MoonshotServerGetDefaultIdentityData {
	int _state_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	MoonshotServer* self;
	char* nai_out;
	char* password_out;
	char* server_certificate_hash;
	char* ca_certificate;
	char* subject_name_constraint;
	char* subject_alt_name_constraint;
	gboolean result;
	IdentityRequest* request;
	char* _tmp0_;
	char* _tmp1_;
	char* _tmp2_;
	char* _tmp3_;
	char* _tmp4_;
	char* _tmp5_;
	char* _tmp6_;
	char* _tmp7_;
	char* _tmp8_;
	char* _tmp9_;
	char* _tmp10_;
	char* _tmp11_;
	char* _tmp12_;
	char* _tmp13_;
	char* _tmp14_;
	char* _tmp15_;
	char* _tmp16_;
	char* _tmp17_;
	Block4Data* _data4_;
};

struct _Rule {
	char* pattern;
	char* always_confirm;
};


extern IdCard** web_provisioning_cards;
extern gint web_provisioning_cards_length1;
static gpointer moonshot_server_parent_class = NULL;

GType moonshot_server_get_type (void) G_GNUC_CONST;
guint moonshot_server_register_object (void* object, GDBusConnection* connection, const gchar* path, GError** error);
GType identity_manager_view_get_type (void) G_GNUC_CONST;
#define MOONSHOT_SERVER_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), TYPE_MOONSHOT_SERVER, MoonshotServerPrivate))
enum  {
	MOONSHOT_SERVER_DUMMY_PROPERTY
};
MoonshotServer* moonshot_server_new (GtkWindow* window);
MoonshotServer* moonshot_server_construct (GType object_type, GtkWindow* window);
static void moonshot_server_get_identity_data_free (gpointer _data);
static void moonshot_server_get_identity_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
void moonshot_server_get_identity (MoonshotServer* self, const char* nai, const char* password, const char* service, GAsyncReadyCallback _callback_, gpointer _user_data_);
gboolean moonshot_server_get_identity_finish (MoonshotServer* self, GAsyncResult* _res_, char** nai_out, char** password_out, char** server_certificate_hash, char** ca_certificate, char** subject_name_constraint, char** subject_alt_name_constraint);
static gboolean moonshot_server_get_identity_co (MoonshotServerGetIdentityData* data);
IdentityRequest* identity_request_new (IdentityManagerView* main_window, const char* nai, const char* password, const char* service);
IdentityRequest* identity_request_construct (GType object_type, IdentityManagerView* main_window, const char* nai, const char* password, const char* service);
GType identity_request_get_type (void) G_GNUC_CONST;
void identity_request_set_callback (IdentityRequest* self, ReturnIdentityCallback cb, void* cb_target, GDestroyNotify cb_target_destroy_notify);
static void _lambda4_ (IdentityRequest* IdentityRequest, Block3Data* _data3_);
static void __lambda4__return_identity_callback (IdentityRequest* request, gpointer self);
gboolean identity_request_execute (IdentityRequest* self);
GType id_card_get_type (void) G_GNUC_CONST;
const char* id_card_get_nai (IdCard* self);
const char* id_card_get_password (IdCard* self);
GType trust_anchor_get_type (void) G_GNUC_CONST;
TrustAnchor* id_card_get_trust_anchor (IdCard* self);
const char* trust_anchor_get_server_cert (TrustAnchor* self);
const char* trust_anchor_get_ca_cert (TrustAnchor* self);
const char* trust_anchor_get_subject (TrustAnchor* self);
const char* trust_anchor_get_subject_alt (TrustAnchor* self);
static Block3Data* block3_data_ref (Block3Data* _data3_);
static void block3_data_unref (Block3Data* _data3_);
static void moonshot_server_get_default_identity_data_free (gpointer _data);
static void moonshot_server_get_default_identity_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
void moonshot_server_get_default_identity (MoonshotServer* self, GAsyncReadyCallback _callback_, gpointer _user_data_);
gboolean moonshot_server_get_default_identity_finish (MoonshotServer* self, GAsyncResult* _res_, char** nai_out, char** password_out, char** server_certificate_hash, char** ca_certificate, char** subject_name_constraint, char** subject_alt_name_constraint);
static gboolean moonshot_server_get_default_identity_co (MoonshotServerGetDefaultIdentityData* data);
IdentityRequest* identity_request_new_default (IdentityManagerView* main_window);
IdentityRequest* identity_request_construct_default (GType object_type, IdentityManagerView* main_window);
static void _lambda5_ (IdentityRequest* IdentityRequest, Block4Data* _data4_);
static void __lambda5__return_identity_callback (IdentityRequest* request, gpointer self);
static Block4Data* block4_data_ref (Block4Data* _data4_);
static void block4_data_unref (Block4Data* _data4_);
gboolean moonshot_server_install_id_card (MoonshotServer* self, const char* display_name, const char* user_name, const char* password, const char* realm, char** rules_patterns, int rules_patterns_length1, char** rules_always_confirm, int rules_always_confirm_length1, char** services, int services_length1, const char* ca_cert, const char* subject, const char* subject_alt, const char* server_cert);
IdCard* id_card_new (void);
IdCard* id_card_construct (GType object_type);
void id_card_set_display_name (IdCard* self, const char* value);
void id_card_set_username (IdCard* self, const char* value);
void id_card_set_password (IdCard* self, const char* value);
void id_card_set_issuer (IdCard* self, const char* value);
void id_card_set_services (IdCard* self, char** value, int value_length1);
void trust_anchor_set_ca_cert (TrustAnchor* self, const char* value);
void trust_anchor_set_subject (TrustAnchor* self, const char* value);
void trust_anchor_set_subject_alt (TrustAnchor* self, const char* value);
void trust_anchor_set_server_cert (TrustAnchor* self, const char* value);
GType rule_get_type (void) G_GNUC_CONST;
Rule* rule_dup (const Rule* self);
void rule_free (Rule* self);
void rule_copy (const Rule* self, Rule* dest);
void rule_destroy (Rule* self);
void id_card_set_rules (IdCard* self, Rule* value, int value_length1);
static void _vala_Rule_array_free (Rule* array, gint array_length);
Rule* id_card_get_rules (IdCard* self, int* result_length1);
gboolean identity_manager_view_add_identity (IdentityManagerView* self, IdCard* id_card);
gint moonshot_server_install_from_file (MoonshotServer* self, const char* file_name);
WebProvisioningParser* web_provisioning_parser_new (const char* path);
WebProvisioningParser* web_provisioning_parser_construct (GType object_type, const char* path);
gpointer web_provisioning_parser_ref (gpointer instance);
void web_provisioning_parser_unref (gpointer instance);
GParamSpec* web_provisioning_param_spec_parser (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void web_provisioning_value_set_parser (GValue* value, gpointer v_object);
void web_provisioning_value_take_parser (GValue* value, gpointer v_object);
gpointer web_provisioning_value_get_parser (const GValue* value);
GType web_provisioning_parser_get_type (void) G_GNUC_CONST;
void web_provisioning_parser_parse (WebProvisioningParser* self);
const char* id_card_get_display_name (IdCard* self);
const char* id_card_get_username (IdCard* self);
const char* id_card_get_issuer (IdCard* self);
char** id_card_get_services (IdCard* self, int* result_length1);
static void moonshot_server_finalize (GObject* obj);
static void moonshot_server_dbus_interface_method_call (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* method_name, GVariant* parameters, GDBusMethodInvocation* invocation, gpointer user_data);
static void _dbus_moonshot_server_get_identity (MoonshotServer* self, GVariant* parameters, GDBusMethodInvocation* invocation);
static void _dbus_moonshot_server_get_identity_ready (GObject * source_object, GAsyncResult * _res_, gpointer * _user_data_);
static void _dbus_moonshot_server_get_default_identity (MoonshotServer* self, GVariant* parameters, GDBusMethodInvocation* invocation);
static void _dbus_moonshot_server_get_default_identity_ready (GObject * source_object, GAsyncResult * _res_, gpointer * _user_data_);
static void _dbus_moonshot_server_install_id_card (MoonshotServer* self, GVariant* parameters, GDBusMethodInvocation* invocation);
static void _dbus_moonshot_server_install_from_file (MoonshotServer* self, GVariant* parameters, GDBusMethodInvocation* invocation);
static GVariant* moonshot_server_dbus_interface_get_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GError** error, gpointer user_data);
static gboolean moonshot_server_dbus_interface_set_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GVariant* value, GError** error, gpointer user_data);
static void _moonshot_server_unregister_object (gpointer user_data);
static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func);

static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_identity_nai = {-1, "nai", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_identity_password = {-1, "password", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_identity_service = {-1, "service", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_identity_nai_out = {-1, "nai_out", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_identity_password_out = {-1, "password_out", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_identity_server_certificate_hash = {-1, "server_certificate_hash", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_identity_ca_certificate = {-1, "ca_certificate", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_identity_subject_name_constraint = {-1, "subject_name_constraint", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_identity_subject_alt_name_constraint = {-1, "subject_alt_name_constraint", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_identity_result = {-1, "result", "b"};
static const GDBusArgInfo * const _moonshot_server_dbus_arg_info_get_identity_in[] = {&_moonshot_server_dbus_arg_info_get_identity_nai, &_moonshot_server_dbus_arg_info_get_identity_password, &_moonshot_server_dbus_arg_info_get_identity_service, NULL};
static const GDBusArgInfo * const _moonshot_server_dbus_arg_info_get_identity_out[] = {&_moonshot_server_dbus_arg_info_get_identity_nai_out, &_moonshot_server_dbus_arg_info_get_identity_password_out, &_moonshot_server_dbus_arg_info_get_identity_server_certificate_hash, &_moonshot_server_dbus_arg_info_get_identity_ca_certificate, &_moonshot_server_dbus_arg_info_get_identity_subject_name_constraint, &_moonshot_server_dbus_arg_info_get_identity_subject_alt_name_constraint, &_moonshot_server_dbus_arg_info_get_identity_result, NULL};
static const GDBusMethodInfo _moonshot_server_dbus_method_info_get_identity = {-1, "GetIdentity", (GDBusArgInfo **) (&_moonshot_server_dbus_arg_info_get_identity_in), (GDBusArgInfo **) (&_moonshot_server_dbus_arg_info_get_identity_out)};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_default_identity_nai_out = {-1, "nai_out", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_default_identity_password_out = {-1, "password_out", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_default_identity_server_certificate_hash = {-1, "server_certificate_hash", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_default_identity_ca_certificate = {-1, "ca_certificate", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_default_identity_subject_name_constraint = {-1, "subject_name_constraint", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_default_identity_subject_alt_name_constraint = {-1, "subject_alt_name_constraint", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_get_default_identity_result = {-1, "result", "b"};
static const GDBusArgInfo * const _moonshot_server_dbus_arg_info_get_default_identity_in[] = {NULL};
static const GDBusArgInfo * const _moonshot_server_dbus_arg_info_get_default_identity_out[] = {&_moonshot_server_dbus_arg_info_get_default_identity_nai_out, &_moonshot_server_dbus_arg_info_get_default_identity_password_out, &_moonshot_server_dbus_arg_info_get_default_identity_server_certificate_hash, &_moonshot_server_dbus_arg_info_get_default_identity_ca_certificate, &_moonshot_server_dbus_arg_info_get_default_identity_subject_name_constraint, &_moonshot_server_dbus_arg_info_get_default_identity_subject_alt_name_constraint, &_moonshot_server_dbus_arg_info_get_default_identity_result, NULL};
static const GDBusMethodInfo _moonshot_server_dbus_method_info_get_default_identity = {-1, "GetDefaultIdentity", (GDBusArgInfo **) (&_moonshot_server_dbus_arg_info_get_default_identity_in), (GDBusArgInfo **) (&_moonshot_server_dbus_arg_info_get_default_identity_out)};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_id_card_display_name = {-1, "display_name", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_id_card_user_name = {-1, "user_name", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_id_card_password = {-1, "password", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_id_card_realm = {-1, "realm", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_id_card_rules_patterns = {-1, "rules_patterns", "as"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_id_card_rules_always_confirm = {-1, "rules_always_confirm", "as"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_id_card_services = {-1, "services", "as"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_id_card_ca_cert = {-1, "ca_cert", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_id_card_subject = {-1, "subject", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_id_card_subject_alt = {-1, "subject_alt", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_id_card_server_cert = {-1, "server_cert", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_id_card_result = {-1, "result", "b"};
static const GDBusArgInfo * const _moonshot_server_dbus_arg_info_install_id_card_in[] = {&_moonshot_server_dbus_arg_info_install_id_card_display_name, &_moonshot_server_dbus_arg_info_install_id_card_user_name, &_moonshot_server_dbus_arg_info_install_id_card_password, &_moonshot_server_dbus_arg_info_install_id_card_realm, &_moonshot_server_dbus_arg_info_install_id_card_rules_patterns, &_moonshot_server_dbus_arg_info_install_id_card_rules_always_confirm, &_moonshot_server_dbus_arg_info_install_id_card_services, &_moonshot_server_dbus_arg_info_install_id_card_ca_cert, &_moonshot_server_dbus_arg_info_install_id_card_subject, &_moonshot_server_dbus_arg_info_install_id_card_subject_alt, &_moonshot_server_dbus_arg_info_install_id_card_server_cert, NULL};
static const GDBusArgInfo * const _moonshot_server_dbus_arg_info_install_id_card_out[] = {&_moonshot_server_dbus_arg_info_install_id_card_result, NULL};
static const GDBusMethodInfo _moonshot_server_dbus_method_info_install_id_card = {-1, "InstallIdCard", (GDBusArgInfo **) (&_moonshot_server_dbus_arg_info_install_id_card_in), (GDBusArgInfo **) (&_moonshot_server_dbus_arg_info_install_id_card_out)};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_from_file_file_name = {-1, "file_name", "s"};
static const GDBusArgInfo _moonshot_server_dbus_arg_info_install_from_file_result = {-1, "result", "i"};
static const GDBusArgInfo * const _moonshot_server_dbus_arg_info_install_from_file_in[] = {&_moonshot_server_dbus_arg_info_install_from_file_file_name, NULL};
static const GDBusArgInfo * const _moonshot_server_dbus_arg_info_install_from_file_out[] = {&_moonshot_server_dbus_arg_info_install_from_file_result, NULL};
static const GDBusMethodInfo _moonshot_server_dbus_method_info_install_from_file = {-1, "InstallFromFile", (GDBusArgInfo **) (&_moonshot_server_dbus_arg_info_install_from_file_in), (GDBusArgInfo **) (&_moonshot_server_dbus_arg_info_install_from_file_out)};
static const GDBusMethodInfo * const _moonshot_server_dbus_method_info[] = {&_moonshot_server_dbus_method_info_get_identity, &_moonshot_server_dbus_method_info_get_default_identity, &_moonshot_server_dbus_method_info_install_id_card, &_moonshot_server_dbus_method_info_install_from_file, NULL};
static const GDBusSignalInfo * const _moonshot_server_dbus_signal_info[] = {NULL};
static const GDBusPropertyInfo * const _moonshot_server_dbus_property_info[] = {NULL};
static const GDBusInterfaceInfo _moonshot_server_dbus_interface_info = {-1, "org.janet.Moonshot", (GDBusMethodInfo **) (&_moonshot_server_dbus_method_info), (GDBusSignalInfo **) (&_moonshot_server_dbus_signal_info), (GDBusPropertyInfo **) (&_moonshot_server_dbus_property_info)};
static const GDBusInterfaceVTable _moonshot_server_dbus_interface_vtable = {moonshot_server_dbus_interface_method_call, moonshot_server_dbus_interface_get_property, moonshot_server_dbus_interface_set_property};


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


#line 8 "moonshot-server.vala"
MoonshotServer* moonshot_server_construct (GType object_type, GtkWindow* window) {
#line 359 "moonshot-server.c"
	MoonshotServer * self = NULL;
	IdentityManagerView* _tmp0_;
#line 8 "moonshot-server.vala"
	g_return_val_if_fail (window != NULL, NULL);
#line 8 "moonshot-server.vala"
	self = (MoonshotServer*) g_object_new (object_type, NULL);
#line 10 "moonshot-server.vala"
	self->priv->main_window = (_tmp0_ = _g_object_ref0 (IDENTITY_MANAGER_VIEW (window)), _g_object_unref0 (self->priv->main_window), _tmp0_);
#line 368 "moonshot-server.c"
	return self;
}


#line 8 "moonshot-server.vala"
MoonshotServer* moonshot_server_new (GtkWindow* window) {
#line 8 "moonshot-server.vala"
	return moonshot_server_construct (TYPE_MOONSHOT_SERVER, window);
#line 377 "moonshot-server.c"
}


static void moonshot_server_get_identity_data_free (gpointer _data) {
	MoonshotServerGetIdentityData* data;
	data = _data;
	_g_free0 (data->nai);
	_g_free0 (data->password);
	_g_free0 (data->service);
	g_object_unref (data->self);
	g_slice_free (MoonshotServerGetIdentityData, data);
}


void moonshot_server_get_identity (MoonshotServer* self, const char* nai, const char* password, const char* service, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	MoonshotServerGetIdentityData* _data_;
	_data_ = g_slice_new0 (MoonshotServerGetIdentityData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, moonshot_server_get_identity);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, moonshot_server_get_identity_data_free);
	_data_->self = g_object_ref (self);
	_data_->nai = g_strdup (nai);
	_data_->password = g_strdup (password);
	_data_->service = g_strdup (service);
	moonshot_server_get_identity_co (_data_);
}


gboolean moonshot_server_get_identity_finish (MoonshotServer* self, GAsyncResult* _res_, char** nai_out, char** password_out, char** server_certificate_hash, char** ca_certificate, char** subject_name_constraint, char** subject_alt_name_constraint) {
	gboolean result;
	MoonshotServerGetIdentityData* _data_;
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
	*nai_out = _data_->nai_out;
	_data_->nai_out = NULL;
	*password_out = _data_->password_out;
	_data_->password_out = NULL;
	*server_certificate_hash = _data_->server_certificate_hash;
	_data_->server_certificate_hash = NULL;
	*ca_certificate = _data_->ca_certificate;
	_data_->ca_certificate = NULL;
	*subject_name_constraint = _data_->subject_name_constraint;
	_data_->subject_name_constraint = NULL;
	*subject_alt_name_constraint = _data_->subject_alt_name_constraint;
	_data_->subject_alt_name_constraint = NULL;
	result = _data_->result;
	return result;
}


static void moonshot_server_get_identity_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	MoonshotServerGetIdentityData* data;
	data = _user_data_;
	data->_res_ = _res_;
	moonshot_server_get_identity_co (data);
}


#line 27 "moonshot-server.vala"
static void _lambda4_ (IdentityRequest* IdentityRequest, Block3Data* _data3_) {
#line 436 "moonshot-server.c"
	MoonshotServer * self;
	self = _data3_->self;
#line 27 "moonshot-server.vala"
	g_return_if_fail (IdentityRequest != NULL);
#line 27 "moonshot-server.vala"
	moonshot_server_get_identity_co (_data3_->_async_data_);
#line 443 "moonshot-server.c"
}


#line 27 "moonshot-server.vala"
static void __lambda4__return_identity_callback (IdentityRequest* request, gpointer self) {
#line 449 "moonshot-server.c"
	_lambda4_ (request, self);
}


static Block3Data* block3_data_ref (Block3Data* _data3_) {
	g_atomic_int_inc (&_data3_->_ref_count_);
	return _data3_;
}


static void block3_data_unref (Block3Data* _data3_) {
	if (g_atomic_int_dec_and_test (&_data3_->_ref_count_)) {
		_g_object_unref0 (_data3_->self);
		g_slice_free (Block3Data, _data3_);
	}
}


static gboolean moonshot_server_get_identity_co (MoonshotServerGetIdentityData* data) {
	switch (data->_state_) {
		case 0:
		goto _state_0;
		default:
		g_assert_not_reached ();
		case 1:
		goto _state_1;
	}
	_state_0:
	data->_data3_ = g_slice_new0 (Block3Data);
	data->_data3_->_ref_count_ = 1;
	data->_data3_->self = g_object_ref (data->self);
	data->_data3_->_async_data_ = data;
	data->request = identity_request_new (data->self->priv->main_window, data->nai, data->password, data->service);
#line 27 "moonshot-server.vala"
	identity_request_set_callback (data->request, __lambda4__return_identity_callback, block3_data_ref (data->_data3_), block3_data_unref);
#line 28 "moonshot-server.vala"
	identity_request_execute (data->request);
#line 487 "moonshot-server.c"
	data->_state_ = 1;
	return FALSE;
	_state_1:
	;
#line 31 "moonshot-server.vala"
	data->nai_out = (data->_tmp0_ = g_strdup (""), _g_free0 (data->nai_out), data->_tmp0_);
#line 32 "moonshot-server.vala"
	data->password_out = (data->_tmp1_ = g_strdup (""), _g_free0 (data->password_out), data->_tmp1_);
#line 33 "moonshot-server.vala"
	data->server_certificate_hash = (data->_tmp2_ = g_strdup (""), _g_free0 (data->server_certificate_hash), data->_tmp2_);
#line 34 "moonshot-server.vala"
	data->ca_certificate = (data->_tmp3_ = g_strdup (""), _g_free0 (data->ca_certificate), data->_tmp3_);
#line 35 "moonshot-server.vala"
	data->subject_name_constraint = (data->_tmp4_ = g_strdup (""), _g_free0 (data->subject_name_constraint), data->_tmp4_);
#line 36 "moonshot-server.vala"
	data->subject_alt_name_constraint = (data->_tmp5_ = g_strdup (""), _g_free0 (data->subject_alt_name_constraint), data->_tmp5_);
#line 504 "moonshot-server.c"
	data->id_card = _g_object_ref0 (data->request->id_card);
#line 40 "moonshot-server.vala"
	if (data->id_card != NULL) {
#line 41 "moonshot-server.vala"
		data->nai_out = (data->_tmp6_ = g_strdup (id_card_get_nai (data->id_card)), _g_free0 (data->nai_out), data->_tmp6_);
#line 42 "moonshot-server.vala"
		data->password_out = (data->_tmp7_ = g_strdup (id_card_get_password (data->id_card)), _g_free0 (data->password_out), data->_tmp7_);
#line 44 "moonshot-server.vala"
		data->server_certificate_hash = (data->_tmp8_ = g_strdup (trust_anchor_get_server_cert (id_card_get_trust_anchor (data->id_card))), _g_free0 (data->server_certificate_hash), data->_tmp8_);
#line 45 "moonshot-server.vala"
		data->ca_certificate = (data->_tmp9_ = g_strdup (trust_anchor_get_ca_cert (id_card_get_trust_anchor (data->id_card))), _g_free0 (data->ca_certificate), data->_tmp9_);
#line 46 "moonshot-server.vala"
		data->subject_name_constraint = (data->_tmp10_ = g_strdup (trust_anchor_get_subject (id_card_get_trust_anchor (data->id_card))), _g_free0 (data->subject_name_constraint), data->_tmp10_);
#line 47 "moonshot-server.vala"
		data->subject_alt_name_constraint = (data->_tmp11_ = g_strdup (trust_anchor_get_subject_alt (id_card_get_trust_anchor (data->id_card))), _g_free0 (data->subject_alt_name_constraint), data->_tmp11_);
#line 49 "moonshot-server.vala"
		if (data->nai_out == NULL) {
#line 50 "moonshot-server.vala"
			data->nai_out = (data->_tmp12_ = g_strdup (""), _g_free0 (data->nai_out), data->_tmp12_);
#line 524 "moonshot-server.c"
		}
#line 51 "moonshot-server.vala"
		if (data->password_out == NULL) {
#line 52 "moonshot-server.vala"
			data->password_out = (data->_tmp13_ = g_strdup (""), _g_free0 (data->password_out), data->_tmp13_);
#line 530 "moonshot-server.c"
		}
#line 53 "moonshot-server.vala"
		if (data->server_certificate_hash == NULL) {
#line 54 "moonshot-server.vala"
			data->server_certificate_hash = (data->_tmp14_ = g_strdup (""), _g_free0 (data->server_certificate_hash), data->_tmp14_);
#line 536 "moonshot-server.c"
		}
#line 55 "moonshot-server.vala"
		if (data->ca_certificate == NULL) {
#line 56 "moonshot-server.vala"
			data->ca_certificate = (data->_tmp15_ = g_strdup (""), _g_free0 (data->ca_certificate), data->_tmp15_);
#line 542 "moonshot-server.c"
		}
#line 57 "moonshot-server.vala"
		if (data->subject_name_constraint == NULL) {
#line 58 "moonshot-server.vala"
			data->subject_name_constraint = (data->_tmp16_ = g_strdup (""), _g_free0 (data->subject_name_constraint), data->_tmp16_);
#line 548 "moonshot-server.c"
		}
#line 59 "moonshot-server.vala"
		if (data->subject_alt_name_constraint == NULL) {
#line 60 "moonshot-server.vala"
			data->subject_alt_name_constraint = (data->_tmp17_ = g_strdup (""), _g_free0 (data->subject_alt_name_constraint), data->_tmp17_);
#line 554 "moonshot-server.c"
		}
		data->result = TRUE;
		_g_object_unref0 (data->id_card);
		_g_object_unref0 (data->request);
		block3_data_unref (data->_data3_);
		{
			if (data->_state_ == 0) {
				g_simple_async_result_complete_in_idle (data->_async_result);
			} else {
				g_simple_async_result_complete (data->_async_result);
			}
			g_object_unref (data->_async_result);
			return FALSE;
		}
	}
	data->result = FALSE;
	_g_object_unref0 (data->id_card);
	_g_object_unref0 (data->request);
	block3_data_unref (data->_data3_);
	{
		if (data->_state_ == 0) {
			g_simple_async_result_complete_in_idle (data->_async_result);
		} else {
			g_simple_async_result_complete (data->_async_result);
		}
		g_object_unref (data->_async_result);
		return FALSE;
	}
	_g_object_unref0 (data->id_card);
	_g_object_unref0 (data->request);
	block3_data_unref (data->_data3_);
	{
		if (data->_state_ == 0) {
			g_simple_async_result_complete_in_idle (data->_async_result);
		} else {
			g_simple_async_result_complete (data->_async_result);
		}
		g_object_unref (data->_async_result);
		return FALSE;
	}
}


static void moonshot_server_get_default_identity_data_free (gpointer _data) {
	MoonshotServerGetDefaultIdentityData* data;
	data = _data;
	g_object_unref (data->self);
	g_slice_free (MoonshotServerGetDefaultIdentityData, data);
}


void moonshot_server_get_default_identity (MoonshotServer* self, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	MoonshotServerGetDefaultIdentityData* _data_;
	_data_ = g_slice_new0 (MoonshotServerGetDefaultIdentityData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, moonshot_server_get_default_identity);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, moonshot_server_get_default_identity_data_free);
	_data_->self = g_object_ref (self);
	moonshot_server_get_default_identity_co (_data_);
}


gboolean moonshot_server_get_default_identity_finish (MoonshotServer* self, GAsyncResult* _res_, char** nai_out, char** password_out, char** server_certificate_hash, char** ca_certificate, char** subject_name_constraint, char** subject_alt_name_constraint) {
	gboolean result;
	MoonshotServerGetDefaultIdentityData* _data_;
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
	*nai_out = _data_->nai_out;
	_data_->nai_out = NULL;
	*password_out = _data_->password_out;
	_data_->password_out = NULL;
	*server_certificate_hash = _data_->server_certificate_hash;
	_data_->server_certificate_hash = NULL;
	*ca_certificate = _data_->ca_certificate;
	_data_->ca_certificate = NULL;
	*subject_name_constraint = _data_->subject_name_constraint;
	_data_->subject_name_constraint = NULL;
	*subject_alt_name_constraint = _data_->subject_alt_name_constraint;
	_data_->subject_alt_name_constraint = NULL;
	result = _data_->result;
	return result;
}


static void moonshot_server_get_default_identity_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	MoonshotServerGetDefaultIdentityData* data;
	data = _user_data_;
	data->_res_ = _res_;
	moonshot_server_get_default_identity_co (data);
}


#line 76 "moonshot-server.vala"
static void _lambda5_ (IdentityRequest* IdentityRequest, Block4Data* _data4_) {
#line 647 "moonshot-server.c"
	MoonshotServer * self;
	self = _data4_->self;
#line 76 "moonshot-server.vala"
	g_return_if_fail (IdentityRequest != NULL);
#line 76 "moonshot-server.vala"
	moonshot_server_get_default_identity_co (_data4_->_async_data_);
#line 654 "moonshot-server.c"
}


#line 76 "moonshot-server.vala"
static void __lambda5__return_identity_callback (IdentityRequest* request, gpointer self) {
#line 660 "moonshot-server.c"
	_lambda5_ (request, self);
}


static Block4Data* block4_data_ref (Block4Data* _data4_) {
	g_atomic_int_inc (&_data4_->_ref_count_);
	return _data4_;
}


static void block4_data_unref (Block4Data* _data4_) {
	if (g_atomic_int_dec_and_test (&_data4_->_ref_count_)) {
		_g_object_unref0 (_data4_->self);
		g_slice_free (Block4Data, _data4_);
	}
}


static gboolean moonshot_server_get_default_identity_co (MoonshotServerGetDefaultIdentityData* data) {
	switch (data->_state_) {
		case 0:
		goto _state_0;
		default:
		g_assert_not_reached ();
		case 2:
		goto _state_2;
	}
	_state_0:
	data->_data4_ = g_slice_new0 (Block4Data);
	data->_data4_->_ref_count_ = 1;
	data->_data4_->self = g_object_ref (data->self);
	data->_data4_->_async_data_ = data;
	data->request = identity_request_new_default (data->self->priv->main_window);
#line 76 "moonshot-server.vala"
	identity_request_set_callback (data->request, __lambda5__return_identity_callback, block4_data_ref (data->_data4_), block4_data_unref);
#line 77 "moonshot-server.vala"
	identity_request_execute (data->request);
#line 698 "moonshot-server.c"
	data->_state_ = 2;
	return FALSE;
	_state_2:
	;
#line 80 "moonshot-server.vala"
	data->nai_out = (data->_tmp0_ = g_strdup (""), _g_free0 (data->nai_out), data->_tmp0_);
#line 81 "moonshot-server.vala"
	data->password_out = (data->_tmp1_ = g_strdup (""), _g_free0 (data->password_out), data->_tmp1_);
#line 82 "moonshot-server.vala"
	data->server_certificate_hash = (data->_tmp2_ = g_strdup (""), _g_free0 (data->server_certificate_hash), data->_tmp2_);
#line 83 "moonshot-server.vala"
	data->ca_certificate = (data->_tmp3_ = g_strdup (""), _g_free0 (data->ca_certificate), data->_tmp3_);
#line 84 "moonshot-server.vala"
	data->subject_name_constraint = (data->_tmp4_ = g_strdup (""), _g_free0 (data->subject_name_constraint), data->_tmp4_);
#line 85 "moonshot-server.vala"
	data->subject_alt_name_constraint = (data->_tmp5_ = g_strdup (""), _g_free0 (data->subject_alt_name_constraint), data->_tmp5_);
#line 87 "moonshot-server.vala"
	if (data->request->id_card != NULL) {
#line 89 "moonshot-server.vala"
		data->nai_out = (data->_tmp6_ = g_strdup (id_card_get_nai (data->request->id_card)), _g_free0 (data->nai_out), data->_tmp6_);
#line 90 "moonshot-server.vala"
		data->password_out = (data->_tmp7_ = g_strdup (id_card_get_password (data->request->id_card)), _g_free0 (data->password_out), data->_tmp7_);
#line 92 "moonshot-server.vala"
		data->server_certificate_hash = (data->_tmp8_ = g_strdup (trust_anchor_get_server_cert (id_card_get_trust_anchor (data->request->id_card))), _g_free0 (data->server_certificate_hash), data->_tmp8_);
#line 93 "moonshot-server.vala"
		data->ca_certificate = (data->_tmp9_ = g_strdup (trust_anchor_get_ca_cert (id_card_get_trust_anchor (data->request->id_card))), _g_free0 (data->ca_certificate), data->_tmp9_);
#line 94 "moonshot-server.vala"
		data->subject_name_constraint = (data->_tmp10_ = g_strdup (trust_anchor_get_subject (id_card_get_trust_anchor (data->request->id_card))), _g_free0 (data->subject_name_constraint), data->_tmp10_);
#line 95 "moonshot-server.vala"
		data->subject_alt_name_constraint = (data->_tmp11_ = g_strdup (trust_anchor_get_subject_alt (id_card_get_trust_anchor (data->request->id_card))), _g_free0 (data->subject_alt_name_constraint), data->_tmp11_);
#line 97 "moonshot-server.vala"
		if (data->nai_out == NULL) {
#line 98 "moonshot-server.vala"
			data->nai_out = (data->_tmp12_ = g_strdup (""), _g_free0 (data->nai_out), data->_tmp12_);
#line 733 "moonshot-server.c"
		}
#line 99 "moonshot-server.vala"
		if (data->password_out == NULL) {
#line 100 "moonshot-server.vala"
			data->password_out = (data->_tmp13_ = g_strdup (""), _g_free0 (data->password_out), data->_tmp13_);
#line 739 "moonshot-server.c"
		}
#line 101 "moonshot-server.vala"
		if (data->server_certificate_hash == NULL) {
#line 102 "moonshot-server.vala"
			data->server_certificate_hash = (data->_tmp14_ = g_strdup (""), _g_free0 (data->server_certificate_hash), data->_tmp14_);
#line 745 "moonshot-server.c"
		}
#line 103 "moonshot-server.vala"
		if (data->ca_certificate == NULL) {
#line 104 "moonshot-server.vala"
			data->ca_certificate = (data->_tmp15_ = g_strdup (""), _g_free0 (data->ca_certificate), data->_tmp15_);
#line 751 "moonshot-server.c"
		}
#line 105 "moonshot-server.vala"
		if (data->subject_name_constraint == NULL) {
#line 106 "moonshot-server.vala"
			data->subject_name_constraint = (data->_tmp16_ = g_strdup (""), _g_free0 (data->subject_name_constraint), data->_tmp16_);
#line 757 "moonshot-server.c"
		}
#line 107 "moonshot-server.vala"
		if (data->subject_alt_name_constraint == NULL) {
#line 108 "moonshot-server.vala"
			data->subject_alt_name_constraint = (data->_tmp17_ = g_strdup (""), _g_free0 (data->subject_alt_name_constraint), data->_tmp17_);
#line 763 "moonshot-server.c"
		}
		data->result = TRUE;
		_g_object_unref0 (data->request);
		block4_data_unref (data->_data4_);
		{
			if (data->_state_ == 0) {
				g_simple_async_result_complete_in_idle (data->_async_result);
			} else {
				g_simple_async_result_complete (data->_async_result);
			}
			g_object_unref (data->_async_result);
			return FALSE;
		}
	}
	data->result = FALSE;
	_g_object_unref0 (data->request);
	block4_data_unref (data->_data4_);
	{
		if (data->_state_ == 0) {
			g_simple_async_result_complete_in_idle (data->_async_result);
		} else {
			g_simple_async_result_complete (data->_async_result);
		}
		g_object_unref (data->_async_result);
		return FALSE;
	}
	_g_object_unref0 (data->request);
	block4_data_unref (data->_data4_);
	{
		if (data->_state_ == 0) {
			g_simple_async_result_complete_in_idle (data->_async_result);
		} else {
			g_simple_async_result_complete (data->_async_result);
		}
		g_object_unref (data->_async_result);
		return FALSE;
	}
}


static void _vala_Rule_array_free (Rule* array, gint array_length) {
	if (array != NULL) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			rule_destroy (&array[i]);
		}
	}
	g_free (array);
}


#line 116 "moonshot-server.vala"
gboolean moonshot_server_install_id_card (MoonshotServer* self, const char* display_name, const char* user_name, const char* password, const char* realm, char** rules_patterns, int rules_patterns_length1, char** rules_always_confirm, int rules_always_confirm_length1, char** services, int services_length1, const char* ca_cert, const char* subject, const char* subject_alt, const char* server_cert) {
#line 817 "moonshot-server.c"
	gboolean result = FALSE;
	IdCard* idcard;
	char** _tmp0_;
#line 116 "moonshot-server.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 116 "moonshot-server.vala"
	g_return_val_if_fail (display_name != NULL, FALSE);
#line 116 "moonshot-server.vala"
	g_return_val_if_fail (user_name != NULL, FALSE);
#line 128 "moonshot-server.vala"
	idcard = id_card_new ();
#line 130 "moonshot-server.vala"
	id_card_set_display_name (idcard, display_name);
#line 131 "moonshot-server.vala"
	id_card_set_username (idcard, user_name);
#line 132 "moonshot-server.vala"
	id_card_set_password (idcard, password);
#line 133 "moonshot-server.vala"
	id_card_set_issuer (idcard, realm);
#line 134 "moonshot-server.vala"
	_tmp0_ = services;
#line 134 "moonshot-server.vala"
	id_card_set_services (idcard, _tmp0_, services_length1);
#line 135 "moonshot-server.vala"
	trust_anchor_set_ca_cert (id_card_get_trust_anchor (idcard), ca_cert);
#line 136 "moonshot-server.vala"
	trust_anchor_set_subject (id_card_get_trust_anchor (idcard), subject);
#line 137 "moonshot-server.vala"
	trust_anchor_set_subject_alt (id_card_get_trust_anchor (idcard), subject_alt);
#line 138 "moonshot-server.vala"
	trust_anchor_set_server_cert (id_card_get_trust_anchor (idcard), server_cert);
#line 140 "moonshot-server.vala"
	if (rules_patterns_length1 == rules_always_confirm_length1) {
#line 851 "moonshot-server.c"
		Rule* _tmp1_;
		gint _tmp1__length1;
		Rule* _tmp2_;
#line 142 "moonshot-server.vala"
		_tmp2_ = (_tmp1_ = g_new0 (Rule, rules_patterns_length1), _tmp1__length1 = rules_patterns_length1, _tmp1_);
#line 142 "moonshot-server.vala"
		id_card_set_rules (idcard, _tmp2_, rules_patterns_length1);
#line 859 "moonshot-server.c"
		_tmp1_ = (_vala_Rule_array_free (_tmp1_, _tmp1__length1), NULL);
		{
			gint i;
#line 144 "moonshot-server.vala"
			i = 0;
#line 865 "moonshot-server.c"
			{
				gboolean _tmp3_;
#line 144 "moonshot-server.vala"
				_tmp3_ = TRUE;
#line 144 "moonshot-server.vala"
				while (TRUE) {
#line 872 "moonshot-server.c"
					gint _tmp4_;
					gint _tmp5_;
					char* *_tmp6_;
					char* _tmp7_;
					gint _tmp8_;
					char* *_tmp9_;
					char* _tmp10_;
#line 144 "moonshot-server.vala"
					if (!_tmp3_) {
#line 144 "moonshot-server.vala"
						i++;
#line 884 "moonshot-server.c"
					}
#line 144 "moonshot-server.vala"
					_tmp3_ = FALSE;
#line 144 "moonshot-server.vala"
					if (!(i < _tmp4_)) {
#line 144 "moonshot-server.vala"
						break;
#line 892 "moonshot-server.c"
					}
#line 146 "moonshot-server.vala"
					_tmp6_ = &id_card_get_rules (idcard, &_tmp5_)[i].pattern;
#line 146 "moonshot-server.vala"
					(*_tmp6_) = (_tmp7_ = g_strdup (rules_patterns[i]), _g_free0 ((*_tmp6_)), _tmp7_);
#line 147 "moonshot-server.vala"
					_tmp9_ = &id_card_get_rules (idcard, &_tmp8_)[i].always_confirm;
#line 147 "moonshot-server.vala"
					(*_tmp9_) = (_tmp10_ = g_strdup (rules_always_confirm[i]), _g_free0 ((*_tmp9_)), _tmp10_);
#line 902 "moonshot-server.c"
				}
			}
		}
	}
	result = identity_manager_view_add_identity (self->priv->main_window, idcard);
	_g_object_unref0 (idcard);
#line 151 "moonshot-server.vala"
	return result;
#line 911 "moonshot-server.c"
}


#line 155 "moonshot-server.vala"
gint moonshot_server_install_from_file (MoonshotServer* self, const char* file_name) {
#line 917 "moonshot-server.c"
	gint result = 0;
	WebProvisioningParser* webp;
	gboolean _result_;
	gint installed_cards;
#line 155 "moonshot-server.vala"
	g_return_val_if_fail (self != NULL, 0);
#line 155 "moonshot-server.vala"
	g_return_val_if_fail (file_name != NULL, 0);
#line 157 "moonshot-server.vala"
	webp = web_provisioning_parser_new (file_name);
#line 159 "moonshot-server.vala"
	web_provisioning_parser_parse (webp);
#line 160 "moonshot-server.vala"
	_result_ = FALSE;
#line 161 "moonshot-server.vala"
	installed_cards = 0;
#line 934 "moonshot-server.c"
	{
		IdCard** card_collection;
		int card_collection_length1;
		int card_it;
#line 162 "moonshot-server.vala"
		card_collection = web_provisioning_cards;
#line 941 "moonshot-server.c"
		card_collection_length1 = web_provisioning_cards_length1;
		for (card_it = 0; card_it < web_provisioning_cards_length1; card_it = card_it + 1) {
			IdCard* card;
			card = _g_object_ref0 (card_collection[card_it]);
			{
				gint rules_patterns_length1;
				gint _rules_patterns_size_;
				char** _tmp1_;
				char** _tmp0_ = NULL;
				char** rules_patterns;
				gint rules_always_confirm_length1;
				gint _rules_always_confirm_size_;
				char** _tmp3_;
				char** _tmp2_ = NULL;
				char** rules_always_confirm;
				gint _tmp4_;
				gint _tmp13_;
				rules_patterns = (_tmp1_ = (_tmp0_ = g_new0 (char*, 0 + 1), _tmp0_), rules_patterns_length1 = 0, _rules_patterns_size_ = rules_patterns_length1, _tmp1_);
				rules_always_confirm = (_tmp3_ = (_tmp2_ = g_new0 (char*, 0 + 1), _tmp2_), rules_always_confirm_length1 = 0, _rules_always_confirm_size_ = rules_always_confirm_length1, _tmp3_);
#line 167 "moonshot-server.vala"
				if (_tmp4_ > 0) {
#line 963 "moonshot-server.c"
					gint i;
					gint _tmp5_;
					char** _tmp6_;
					gint _tmp7_;
					char** _tmp8_;
#line 169 "moonshot-server.vala"
					i = 0;
#line 170 "moonshot-server.vala"
					rules_patterns = (_tmp6_ = g_new0 (char*, _tmp5_ + 1), rules_patterns = (_vala_array_free (rules_patterns, rules_patterns_length1, (GDestroyNotify) g_free), NULL), rules_patterns_length1 = _tmp5_, _rules_patterns_size_ = rules_patterns_length1, _tmp6_);
#line 171 "moonshot-server.vala"
					rules_always_confirm = (_tmp8_ = g_new0 (char*, _tmp7_ + 1), rules_always_confirm = (_vala_array_free (rules_always_confirm, rules_always_confirm_length1, (GDestroyNotify) g_free), NULL), rules_always_confirm_length1 = _tmp7_, _rules_always_confirm_size_ = rules_always_confirm_length1, _tmp8_);
#line 975 "moonshot-server.c"
					{
						gint _tmp9_;
						Rule* r_collection;
						int r_collection_length1;
						int r_it;
#line 172 "moonshot-server.vala"
						r_collection = id_card_get_rules (card, &_tmp9_);
#line 983 "moonshot-server.c"
						r_collection_length1 = _tmp9_;
						for (r_it = 0; r_it < _tmp9_; r_it = r_it + 1) {
							Rule _tmp12_ = {0};
							Rule r;
							r = (rule_copy (&r_collection[r_it], &_tmp12_), _tmp12_);
							{
								char* _tmp10_;
								char* _tmp11_;
#line 174 "moonshot-server.vala"
								rules_patterns[i] = (_tmp10_ = g_strdup (r.pattern), _g_free0 (rules_patterns[i]), _tmp10_);
#line 175 "moonshot-server.vala"
								rules_always_confirm[i] = (_tmp11_ = g_strdup (r.always_confirm), _g_free0 (rules_always_confirm[i]), _tmp11_);
#line 176 "moonshot-server.vala"
								i++;
#line 998 "moonshot-server.c"
								rule_destroy (&r);
							}
						}
					}
				}
#line 180 "moonshot-server.vala"
				_result_ = moonshot_server_install_id_card (self, id_card_get_display_name (card), id_card_get_username (card), id_card_get_password (card), id_card_get_issuer (card), rules_patterns, rules_patterns_length1, rules_always_confirm, rules_always_confirm_length1, id_card_get_services (card, &_tmp13_), _tmp13_, trust_anchor_get_ca_cert (id_card_get_trust_anchor (card)), trust_anchor_get_subject (id_card_get_trust_anchor (card)), trust_anchor_get_subject_alt (id_card_get_trust_anchor (card)), trust_anchor_get_server_cert (id_card_get_trust_anchor (card)));
#line 191 "moonshot-server.vala"
				if (_result_) {
#line 192 "moonshot-server.vala"
					installed_cards++;
#line 1010 "moonshot-server.c"
				}
				rules_always_confirm = (_vala_array_free (rules_always_confirm, rules_always_confirm_length1, (GDestroyNotify) g_free), NULL);
				rules_patterns = (_vala_array_free (rules_patterns, rules_patterns_length1, (GDestroyNotify) g_free), NULL);
				_g_object_unref0 (card);
			}
		}
	}
	result = installed_cards;
	_web_provisioning_parser_unref0 (webp);
#line 195 "moonshot-server.vala"
	return result;
#line 1022 "moonshot-server.c"
}


static void moonshot_server_class_init (MoonshotServerClass * klass) {
	moonshot_server_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (MoonshotServerPrivate));
	G_OBJECT_CLASS (klass)->finalize = moonshot_server_finalize;
}


static void moonshot_server_instance_init (MoonshotServer * self) {
	self->priv = MOONSHOT_SERVER_GET_PRIVATE (self);
}


static void moonshot_server_finalize (GObject* obj) {
	MoonshotServer * self;
	self = MOONSHOT_SERVER (obj);
	_g_object_unref0 (self->priv->main_window);
	G_OBJECT_CLASS (moonshot_server_parent_class)->finalize (obj);
}


GType moonshot_server_get_type (void) {
	static volatile gsize moonshot_server_type_id__volatile = 0;
	if (g_once_init_enter (&moonshot_server_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (MoonshotServerClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) moonshot_server_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (MoonshotServer), 0, (GInstanceInitFunc) moonshot_server_instance_init, NULL };
		GType moonshot_server_type_id;
		moonshot_server_type_id = g_type_register_static (G_TYPE_OBJECT, "MoonshotServer", &g_define_type_info, 0);
		g_once_init_leave (&moonshot_server_type_id__volatile, moonshot_server_type_id);
	}
	return moonshot_server_type_id__volatile;
}


static void _dbus_moonshot_server_get_identity (MoonshotServer* self, GVariant* parameters, GDBusMethodInvocation* invocation) {
	char* nai = NULL;
	GVariant* _tmp0_;
	char* password = NULL;
	GVariant* _tmp1_;
	char* service = NULL;
	GVariant* _tmp2_;
	GVariantIter _arguments_iter;
	g_variant_iter_init (&_arguments_iter, parameters);
	_tmp0_ = g_variant_iter_next_value (&_arguments_iter);
	nai = g_variant_dup_string (_tmp0_, NULL);
	g_variant_unref (_tmp0_);
	_tmp1_ = g_variant_iter_next_value (&_arguments_iter);
	password = g_variant_dup_string (_tmp1_, NULL);
	g_variant_unref (_tmp1_);
	_tmp2_ = g_variant_iter_next_value (&_arguments_iter);
	service = g_variant_dup_string (_tmp2_, NULL);
	g_variant_unref (_tmp2_);
	moonshot_server_get_identity (self, nai, password, service, (GAsyncReadyCallback) _dbus_moonshot_server_get_identity_ready, g_object_ref (invocation));
	_g_free0 (nai);
	_g_free0 (password);
	_g_free0 (service);
}


static void _dbus_moonshot_server_get_identity_ready (GObject * source_object, GAsyncResult * _res_, gpointer * _user_data_) {
	GDBusMethodInvocation * invocation;
	GError* error;
	char* nai_out = NULL;
	char* password_out = NULL;
	char* server_certificate_hash = NULL;
	char* ca_certificate = NULL;
	char* subject_name_constraint = NULL;
	char* subject_alt_name_constraint = NULL;
	gboolean result;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	invocation = _user_data_;
	error = NULL;
	result = moonshot_server_get_identity_finish ((MoonshotServer*) source_object, _res_, &nai_out, &password_out, &server_certificate_hash, &ca_certificate, &subject_name_constraint, &subject_alt_name_constraint);
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (nai_out));
	_g_free0 (nai_out);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (password_out));
	_g_free0 (password_out);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (server_certificate_hash));
	_g_free0 (server_certificate_hash);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (ca_certificate));
	_g_free0 (ca_certificate);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (subject_name_constraint));
	_g_free0 (subject_name_constraint);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (subject_alt_name_constraint));
	_g_free0 (subject_alt_name_constraint);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_boolean (result));
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_method_invocation_return_value (invocation, _reply);
	g_object_unref (invocation);
	g_variant_unref (_reply);
}


static void _dbus_moonshot_server_get_default_identity (MoonshotServer* self, GVariant* parameters, GDBusMethodInvocation* invocation) {
	GVariantIter _arguments_iter;
	g_variant_iter_init (&_arguments_iter, parameters);
	moonshot_server_get_default_identity (self, (GAsyncReadyCallback) _dbus_moonshot_server_get_default_identity_ready, g_object_ref (invocation));
}


static void _dbus_moonshot_server_get_default_identity_ready (GObject * source_object, GAsyncResult * _res_, gpointer * _user_data_) {
	GDBusMethodInvocation * invocation;
	GError* error;
	char* nai_out = NULL;
	char* password_out = NULL;
	char* server_certificate_hash = NULL;
	char* ca_certificate = NULL;
	char* subject_name_constraint = NULL;
	char* subject_alt_name_constraint = NULL;
	gboolean result;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	invocation = _user_data_;
	error = NULL;
	result = moonshot_server_get_default_identity_finish ((MoonshotServer*) source_object, _res_, &nai_out, &password_out, &server_certificate_hash, &ca_certificate, &subject_name_constraint, &subject_alt_name_constraint);
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (nai_out));
	_g_free0 (nai_out);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (password_out));
	_g_free0 (password_out);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (server_certificate_hash));
	_g_free0 (server_certificate_hash);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (ca_certificate));
	_g_free0 (ca_certificate);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (subject_name_constraint));
	_g_free0 (subject_name_constraint);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (subject_alt_name_constraint));
	_g_free0 (subject_alt_name_constraint);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_boolean (result));
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_method_invocation_return_value (invocation, _reply);
	g_object_unref (invocation);
	g_variant_unref (_reply);
}


static void _dbus_moonshot_server_install_id_card (MoonshotServer* self, GVariant* parameters, GDBusMethodInvocation* invocation) {
	GError* error;
	char* display_name = NULL;
	GVariant* _tmp3_;
	char* user_name = NULL;
	GVariant* _tmp4_;
	char* password = NULL;
	GVariant* _tmp5_;
	char* realm = NULL;
	GVariant* _tmp6_;
	char** rules_patterns = NULL;
	int rules_patterns_length1;
	GVariant* _tmp7_;
	char** _tmp8_;
	int _tmp8__length;
	int _tmp8__size;
	int _tmp8__length1;
	GVariantIter _tmp9_;
	GVariant* _tmp10_;
	char** rules_always_confirm = NULL;
	int rules_always_confirm_length1;
	GVariant* _tmp11_;
	char** _tmp12_;
	int _tmp12__length;
	int _tmp12__size;
	int _tmp12__length1;
	GVariantIter _tmp13_;
	GVariant* _tmp14_;
	char** services = NULL;
	int services_length1;
	GVariant* _tmp15_;
	char** _tmp16_;
	int _tmp16__length;
	int _tmp16__size;
	int _tmp16__length1;
	GVariantIter _tmp17_;
	GVariant* _tmp18_;
	char* ca_cert = NULL;
	GVariant* _tmp19_;
	char* subject = NULL;
	GVariant* _tmp20_;
	char* subject_alt = NULL;
	GVariant* _tmp21_;
	char* server_cert = NULL;
	GVariant* _tmp22_;
	gboolean result;
	GVariantIter _arguments_iter;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	error = NULL;
	g_variant_iter_init (&_arguments_iter, parameters);
	_tmp3_ = g_variant_iter_next_value (&_arguments_iter);
	display_name = g_variant_dup_string (_tmp3_, NULL);
	g_variant_unref (_tmp3_);
	_tmp4_ = g_variant_iter_next_value (&_arguments_iter);
	user_name = g_variant_dup_string (_tmp4_, NULL);
	g_variant_unref (_tmp4_);
	_tmp5_ = g_variant_iter_next_value (&_arguments_iter);
	password = g_variant_dup_string (_tmp5_, NULL);
	g_variant_unref (_tmp5_);
	_tmp6_ = g_variant_iter_next_value (&_arguments_iter);
	realm = g_variant_dup_string (_tmp6_, NULL);
	g_variant_unref (_tmp6_);
	rules_patterns_length1 = 0;
	_tmp7_ = g_variant_iter_next_value (&_arguments_iter);
	_tmp8_ = g_new (char*, 5);
	_tmp8__length = 0;
	_tmp8__size = 4;
	_tmp8__length1 = 0;
	g_variant_iter_init (&_tmp9_, _tmp7_);
	for (; _tmp10_ = g_variant_iter_next_value (&_tmp9_); _tmp8__length1++) {
		if (_tmp8__size == _tmp8__length) {
			_tmp8__size = 2 * _tmp8__size;
			_tmp8_ = g_renew (char*, _tmp8_, _tmp8__size + 1);
		}
		_tmp8_[_tmp8__length++] = g_variant_dup_string (_tmp10_, NULL);
		g_variant_unref (_tmp10_);
	}
	rules_patterns_length1 = _tmp8__length1;
	_tmp8_[_tmp8__length] = NULL;
	rules_patterns = _tmp8_;
	g_variant_unref (_tmp7_);
	rules_always_confirm_length1 = 0;
	_tmp11_ = g_variant_iter_next_value (&_arguments_iter);
	_tmp12_ = g_new (char*, 5);
	_tmp12__length = 0;
	_tmp12__size = 4;
	_tmp12__length1 = 0;
	g_variant_iter_init (&_tmp13_, _tmp11_);
	for (; _tmp14_ = g_variant_iter_next_value (&_tmp13_); _tmp12__length1++) {
		if (_tmp12__size == _tmp12__length) {
			_tmp12__size = 2 * _tmp12__size;
			_tmp12_ = g_renew (char*, _tmp12_, _tmp12__size + 1);
		}
		_tmp12_[_tmp12__length++] = g_variant_dup_string (_tmp14_, NULL);
		g_variant_unref (_tmp14_);
	}
	rules_always_confirm_length1 = _tmp12__length1;
	_tmp12_[_tmp12__length] = NULL;
	rules_always_confirm = _tmp12_;
	g_variant_unref (_tmp11_);
	services_length1 = 0;
	_tmp15_ = g_variant_iter_next_value (&_arguments_iter);
	_tmp16_ = g_new (char*, 5);
	_tmp16__length = 0;
	_tmp16__size = 4;
	_tmp16__length1 = 0;
	g_variant_iter_init (&_tmp17_, _tmp15_);
	for (; _tmp18_ = g_variant_iter_next_value (&_tmp17_); _tmp16__length1++) {
		if (_tmp16__size == _tmp16__length) {
			_tmp16__size = 2 * _tmp16__size;
			_tmp16_ = g_renew (char*, _tmp16_, _tmp16__size + 1);
		}
		_tmp16_[_tmp16__length++] = g_variant_dup_string (_tmp18_, NULL);
		g_variant_unref (_tmp18_);
	}
	services_length1 = _tmp16__length1;
	_tmp16_[_tmp16__length] = NULL;
	services = _tmp16_;
	g_variant_unref (_tmp15_);
	_tmp19_ = g_variant_iter_next_value (&_arguments_iter);
	ca_cert = g_variant_dup_string (_tmp19_, NULL);
	g_variant_unref (_tmp19_);
	_tmp20_ = g_variant_iter_next_value (&_arguments_iter);
	subject = g_variant_dup_string (_tmp20_, NULL);
	g_variant_unref (_tmp20_);
	_tmp21_ = g_variant_iter_next_value (&_arguments_iter);
	subject_alt = g_variant_dup_string (_tmp21_, NULL);
	g_variant_unref (_tmp21_);
	_tmp22_ = g_variant_iter_next_value (&_arguments_iter);
	server_cert = g_variant_dup_string (_tmp22_, NULL);
	g_variant_unref (_tmp22_);
	result = moonshot_server_install_id_card (self, display_name, user_name, password, realm, rules_patterns, rules_patterns_length1, rules_always_confirm, rules_always_confirm_length1, services, services_length1, ca_cert, subject, subject_alt, server_cert);
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	_g_free0 (display_name);
	_g_free0 (user_name);
	_g_free0 (password);
	_g_free0 (realm);
	rules_patterns = (_vala_array_free (rules_patterns, rules_patterns_length1, (GDestroyNotify) g_free), NULL);
	rules_always_confirm = (_vala_array_free (rules_always_confirm, rules_always_confirm_length1, (GDestroyNotify) g_free), NULL);
	services = (_vala_array_free (services, services_length1, (GDestroyNotify) g_free), NULL);
	_g_free0 (ca_cert);
	_g_free0 (subject);
	_g_free0 (subject_alt);
	_g_free0 (server_cert);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_boolean (result));
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_method_invocation_return_value (invocation, _reply);
}


static void _dbus_moonshot_server_install_from_file (MoonshotServer* self, GVariant* parameters, GDBusMethodInvocation* invocation) {
	GError* error;
	char* file_name = NULL;
	GVariant* _tmp23_;
	gint result;
	GVariantIter _arguments_iter;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	error = NULL;
	g_variant_iter_init (&_arguments_iter, parameters);
	_tmp23_ = g_variant_iter_next_value (&_arguments_iter);
	file_name = g_variant_dup_string (_tmp23_, NULL);
	g_variant_unref (_tmp23_);
	result = moonshot_server_install_from_file (self, file_name);
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	_g_free0 (file_name);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_int32 (result));
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_method_invocation_return_value (invocation, _reply);
}


static void moonshot_server_dbus_interface_method_call (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* method_name, GVariant* parameters, GDBusMethodInvocation* invocation, gpointer user_data) {
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
	if (strcmp (method_name, "GetIdentity") == 0) {
		_dbus_moonshot_server_get_identity (object, parameters, invocation);
	} else if (strcmp (method_name, "GetDefaultIdentity") == 0) {
		_dbus_moonshot_server_get_default_identity (object, parameters, invocation);
	} else if (strcmp (method_name, "InstallIdCard") == 0) {
		_dbus_moonshot_server_install_id_card (object, parameters, invocation);
	} else if (strcmp (method_name, "InstallFromFile") == 0) {
		_dbus_moonshot_server_install_from_file (object, parameters, invocation);
	}
}


static GVariant* moonshot_server_dbus_interface_get_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GError** error, gpointer user_data) {
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
	return NULL;
}


static gboolean moonshot_server_dbus_interface_set_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GVariant* value, GError** error, gpointer user_data) {
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
	return FALSE;
}


guint moonshot_server_register_object (gpointer object, GDBusConnection* connection, const gchar* path, GError** error) {
	guint result;
	gpointer *data;
	data = g_new (gpointer, 3);
	data[0] = g_object_ref (object);
	data[1] = g_object_ref (connection);
	data[2] = g_strdup (path);
	result = g_dbus_connection_register_object (connection, path, &_moonshot_server_dbus_interface_info, &_moonshot_server_dbus_interface_vtable, data, _moonshot_server_unregister_object, error);
	if (!result) {
		return 0;
	}
	return result;
}


static void _moonshot_server_unregister_object (gpointer user_data) {
	gpointer* data;
	data = user_data;
	g_object_unref (data[0]);
	g_object_unref (data[1]);
	g_free (data[2]);
	g_free (data);
}


static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	if ((array != NULL) && (destroy_func != NULL)) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}


static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}




